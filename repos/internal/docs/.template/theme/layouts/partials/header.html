<header>
  <h1 {{ if .IsHome }}class="emoji-maiz"{{end}}>{{ if .IsHome }}milpa{{else}}<a class="emoji-maiz" href="/">milpa</a>{{end}}</h1>
  <input
    list="milpa-commands"
    placeholder="type a milpa command"
    type="text"
    id="command-selector"
    value="{{ if not .IsHome }}{{ replace (trim .RelPermalink "/") "/" " " }}{{ end }}" />
  <datalist id="milpa-commands">
    {{ range (union .Site.Home.Pages .Site.Home.Sections).ByWeight }}
    {{ template "command-autocomplete-list" . }}
    {{ end }}
  </datalist>
</header>

{{ define "command-autocomplete-list" -}}
{{- $page := . -}}
{{- $subPages := (union .Pages .Sections).ByWeight -}}
{{- $hasChildren := gt (len $subPages) 0 -}}
<option value="{{ replace (trim .RelPermalink "/") "/" " " }}" />
{{ if $hasChildren }}
{{ range $subPages }}
{{ template "command-autocomplete-list" .}}
{{ end }}
{{ end }}
{{ end }}
